<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>메리나 크리스마스</title>

<style>
  body {
    margin: 0;
    padding: 30px;
    background: #0e0e0e;
    color: #eee;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  }

  .container {
    max-width: 860px;
    margin: auto;
  }

  .now-playing {
    margin-bottom: 12px;
    font-size: 0.95em;
    color: #bbb;
  }

  .player {
    aspect-ratio: 16 / 9;
    background: black;
    margin-bottom: 20px;
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }

  .controls {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
  }

  button {
    background: #1f1f1f;
    color: #eee;
    border: none;
    padding: 10px 14px;
    border-radius: 6px;
    cursor: pointer;
  }

  button.active {
    background: #444;
  }

  .playlist {
    display: grid;
    gap: 10px;
  }

  .track {
    padding: 14px;
    background: #161616;
    border-radius: 8px;
    cursor: pointer;
  }

  .track:hover {
    background: #2a2a2a;
  }

  .track.active {
    background: #3a3a3a;
  }

  .track span {
    font-size: 0.85em;
    color: #aaa;
  }
</style>
</head>

<body>
<div class="container">

  <div class="now-playing" id="nowPlaying">Now Playing: —</div>

  <div class="player">
    <iframe id="player"
      src=""
      allow="autoplay; encrypted-media"
      allowfullscreen>
    </iframe>
  </div>

  <div class="controls">
    <button onclick="prevTrack()">◀ Prev</button>
    <button onclick="nextTrack()">Next ▶</button>
    <button id="shuffleBtn" onclick="toggleShuffle()">Shuffle</button>
  </div>

  <div class="playlist" id="playlist"></div>

</div>

<script>
const tracks = [
  {
    title: "Santa Tell Me",
    note: "",
    videoId: "UDJJnVyUvmA",
    start: 149
  },
  {
    title: "White Christmas",
    note: "Jazz Ver.",
    videoId: "f5V0PpyTXNI",
    start: 95
  },
{
title: "싱숭생숭",
note: "with 다이나믹 듀오",
videoId: "C_zfF1xdYHQ",
start: 1
}
];

let currentIndex = 0;
let shuffle = false;

const player = document.getElementById("player");
const playlistEl = document.getElementById("playlist");
const nowPlaying = document.getElementById("nowPlaying");
const shuffleBtn = document.getElementById("shuffleBtn");

function loadPlaylist() {
  playlistEl.innerHTML = "";
  tracks.forEach((track, index) => {
    const div = document.createElement("div");
    div.className = "track";
    div.innerHTML = `<strong>${track.title}</strong><br><span>${track.note}</span>`;
    div.onclick = () => playTrack(index);
    playlistEl.appendChild(div);
  });
}

function playTrack(index) {
  currentIndex = index;
  const track = tracks[index];
  player.src = `https://www.youtube.com/embed/${track.videoId}?start=${track.start}&autoplay=1&enablejsapi=1`;
  nowPlaying.textContent = `Now Playing: ${track.title}`;
  updateActive();
}

function updateActive() {
  document.querySelectorAll(".track").forEach((el, i) => {
    el.classList.toggle("active", i === currentIndex);
  });
}

function nextTrack() {
  if (shuffle) {
    currentIndex = Math.floor(Math.random() * tracks.length);
  } else {
    currentIndex = (currentIndex + 1) % tracks.length;
  }
  playTrack(currentIndex);
}

function prevTrack() {
  currentIndex = (currentIndex - 1 + tracks.length) % tracks.length;
  playTrack(currentIndex);
}

function toggleShuffle() {
  shuffle = !shuffle;
  shuffleBtn.classList.toggle("active", shuffle);
}

loadPlaylist();
playTrack(0);

// 자동 다음곡 (영상 종료 후)
window.addEventListener("message", (e) => {
  if (typeof e.data === "string" && e.data.includes("ended")) {
    nextTrack();
  }
});
</script>

</body>
</html>
